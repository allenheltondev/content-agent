# Design Document

## Overview

This feature enhances the blog editor by displaying a 3-sentence content summary that's already available from the get-suggestions API endpoint. The summary will be integrated into the existing editor interface to provide users with a quick overview of their content without disrupting the editing workflow.

## Architecture

### Data Flow
1. The get-suggestions API already returns a `summary` field alongside suggestions
2. The frontend API service will be updated to handle the summary in the response
3. The suggestion manager will store and provide access to the summary
4. A new summary component will display the summary in the editor interface

### Integration Points
- **API Layer**: Update `SuggestionsResponse` type and `ApiService.getSuggestions()` method
- **State Management**: Extend `useSuggestionManager` to handle summary data
- **UI Layer**: Create new `ContentSummary` component and integrate into editor

## Components and Interfaces

### Type Definitions

```typescript
// Update existing SuggestionsResponse interface
export interface SuggestionsResponse {
  suggestions: Suggestion[];
  summary?: string; // Add optional summary field
}

// New interface for summary component props
export interface ContentSummaryProps {
  summary: string;
  isLoading?: boolean;
  className?: string;
}
```

### API Service Updates

```typescript
// Update getSuggestions method to return both suggestions and summary
async getSuggestions(postId: string, signal?: AbortSignal): Promise<{
  suggestions: Suggestion[];
  summary?: string;
}> {
  const response = await this.get<SuggestionsResponse>(`/api/posts/${encodeURIComponent(postId)}/suggestions`, signal);
  return {
    suggestions: response.suggestions || [],
    summary: response.summary
  };
}
```

### Suggestion Manager Updates

```typescript
// Extend SuggestionManagerState to include summary
export interface SuggestionManagerState {
  allSuggestions: Suggestion[];
  acceptedSuggestions: string[];
  rejectedSuggestions: string[];
  undoHistory: SuggestionUndoAction[];
  summary?: string; // Add summary field
  isLoading: boolean;
  error: string | null;
  currentPostId: string | null;
}

// Update hook return type to include summary
return {
  // ... existing returns
  summary: state.summary,
  // ... rest of returns
};
```

### ContentSummary Component

```typescript
// New component for displaying content summary
export function ContentSummary({ summary, isLoading, className }: ContentSummaryProps) {
  if (isLoading) {
    return <SummaryLoadingSkeleton />;
  }

  if (!summary) {
    return null; // Gracefully handle missing summary
  }

  return (
    <div className={`content-summary ${className}`}>
      <h3>Content Summary</h3>
      <p>{summary}</p>
    </div>
  );
}
```

## Data Models

### Summary Data Structure
- **Type**: Optional string field in API response
- **Content**: 3-sentence summary generated by backend agents
- **Lifecycle**: Tied to content version, updated when content is re-analyzed

### State Management
- Summary stored in `useSuggestionManager` state alongside suggestions
- Summary cleared when switching between posts
- Summary persisted in component state during editing session

## Error Handling

### API Failures
- If summary fails to load, component renders nothing (graceful degradation)
- Summary loading errors don't affect suggestion loading or editor functionality
- Error states logged but not displayed to user (non-critical feature)

### Missing Data
- Component handles undefined/null summary gracefully
- No error messages or empty states shown for missing summaries
- Editor remains fully functional without summary

### Loading States
- Show subtle loading skeleton while summary loads
- Don't block editor interface during summary loading
- Summary loads alongside suggestions in single API call

## Testing Strategy

### Component Testing
- Test ContentSummary component with various summary lengths
- Test loading and empty states
- Test responsive design and accessibility

### Integration Testing
- Test summary display in full editor context
- Test summary updates when content is re-analyzed
- Test error handling when API fails

### API Testing
- Verify getSuggestions returns summary field correctly
- Test backward compatibility with responses that don't include summary
- Test summary content formatting and length

## UI/UX Design

### Visual Design
- **Card Style**: Subtle background with rounded corners, distinct from suggestion cards
- **Typography**: Readable font size with appropriate line height for 3-sentence content
- **Color Scheme**: Neutral background (light gray/blue) with standard text color
- **Spacing**: Adequate padding and margins for comfortable reading

### Positioning
- **Location**: Above suggestions list, below editor toolbar
- **Layout**: Full-width card that doesn't interfere with editing
- **Responsive**: Adapts to different screen sizes appropriately

### Interaction
- **Static Display**: No interactive elements (view-only)
- **Loading State**: Subtle skeleton animation during load
- **Accessibility**: Proper ARIA labels and semantic HTML structure

## Implementation Approach

### Phase 1: Backend Integration
1. Update TypeScript interfaces for API response
2. Modify ApiService.getSuggestions() to handle summary
3. Update useSuggestionManager to store and expose summary

### Phase 2: UI Component
1. Create ContentSummary component with proper styling
2. Add loading skeleton component
3. Implement responsive design and accessibility features

### Phase 3: Integration
1. Integrate ContentSummary into editor layout
2. Connect to suggestion manager state
3. Test full user workflow and edge cases

### Styling Approach
- Use existing Tailwind utility classes for consistency
- Follow project's design system for colors and spacing
- Ensure component fits naturally with existing editor UI
